---
author: zjmantou
title: 04虚拟机性能监控与故障处理工具
time: 2023-11-13 周一
tags:
  - Java
  - Java虚拟机
  - 笔记
---

给一个系统定位问题的时候，知识、经验是关键基础，数据是依据，工具是运用知识处理数据的手段。这里说的数据包括：运行日志、异常堆栈、GC日志、线程快照（threaddump/javacore文件）、堆转储快照（heapdump/hprof文件）等

# JDK命令行工具

JDK bin中除了Java 和 Javac外还有很多其他的工具 

![album_temp_1699804988.png](https://zjmantou-drawingbed.oss-cn-hangzhou.aliyuncs.com/picture/202311130003515.png)


## JDK监控和故障处理工具

![album_temp_1699805075.png](https://zjmantou-drawingbed.oss-cn-hangzhou.aliyuncs.com/picture/202311130005465.png)


### jps：虚拟机进程状况工具

Java Process Status Tool  

命令格式： 

`jps [ options ] [ hostid ]` 

jps执行样例：

```shell
​​D:\Develop\Java\jdk1.6.0_21\bin>jps -l￼ 2388 D:\Develop\glassfish\bin\..\modules\admin-cli.jar￼ 2764 com.sun.enterprise.glassfish.bootstrap.ASMain￼ 3788 sun.tools.jps.Jps​​
```

jps工具主要选项：
- -q：只输出LVMID（Local Virtual Machine Identifier，本地虚拟机唯一ID）
- -m：输出虚拟机进程启动时传递给朱类main()函数的参数
- -l：输出主类全面，如果进程执行的是Jar包，输出Jar路径
- -v：输出虚拟机进程启动时JVM参数

### jstat：虚拟机统计信息监视工具

JVM Statistics Monitoring Tool，是用于监控虚拟机各种允许状态信息的命令行工具。它可以显示本地或远程虚拟机进程中的类装载、内存、垃圾收集、JIT编译等运行数据。 

jstat命令格式为：
`​​jstat [ option vmid [interval[s|ms] [count]] ]​​`

vmid：如果本地虚拟机进程，则VMID与LVMID是一致的，如果是远程虚拟机进程，那VMID格式为： 
`[protocol:][//]lvmid[@hostname[:port]/servername]​​`

interval和count：代表查询间隔和次数，如果省略这两个，说明只查询一次。 

option，代表用户希望查询的虚拟机信息：
- 类装载
- 垃圾收集
- 运行期变异状况

![jstat工具主要选项.png](https://zjmantou-drawingbed.oss-cn-hangzhou.aliyuncs.com/picture/202311130017019.png)

### jinfo：Java配置信息工具

Configuration Info for Java，实时地查看和调整虚拟机各项参数。

命令格式为： 
`jinfo [ option ] pid`  

### jmap：Java内存映像工具 

用于生成堆转储快照（dump文件）。 

命令格式： 
`jmap [ option ] vmid`  

![album_temp_1699951176.png](https://zjmantou-drawingbed.oss-cn-hangzhou.aliyuncs.com/picture/202311141652419.png)


### jhat：虚拟机堆转储快找分析工具

### jstack：Java堆栈跟踪工具

`jstack [option] vmid` 

![album_temp_1699952005.png](https://zjmantou-drawingbed.oss-cn-hangzhou.aliyuncs.com/picture/202311141654807.png)


### HSDIS：JIT生成代码反汇编 

# JDK可视化工具

## jConsole：Java监视与管理控制台

## VisualVM：多合一故障处理工具 

